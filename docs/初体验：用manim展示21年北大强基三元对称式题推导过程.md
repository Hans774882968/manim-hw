[TOC]

## 写代码

代码传送门：`pku_2021_sf_abc_problem.py`

初版代码提示词：

```
大佬，你是一名数学科研工作者，精通manim。请叫我hans7。我有一道题《2021北大强基： $a=ab+c$ ， $b=bc+a$ ， $c=ca+b$ ，求 $a+b+c$》。我为这题写好了一个正确的推理过程的文章，markdown格式。请写一段manim代码展示这篇文章。文章全文如下：
```

个人感觉，即使用通义千问帮忙写代码，这也还是个脏活累活，而且展示的效果也一般，感觉还不如写好PPT/博客+录屏演示。以后考虑只用manim展示需要画图像的题目

心得：

1. 通义千问似乎不太删除manim编程，我们需要给通义千问定规范，让它把说明文字和公式一组一组地展示。未整合的提示词如下：

```
大佬，希望你把我博客的一段话文字说明用Text包起来，和公式构成一个VGroup一起展示。比如，为了展示：

为了弄出 $abc$ ，我们分别乘c、a、b：

$$
ac = abc+c^2,\ ab = abc+a^2,\ bc = abc+b^2
$$

这段话，我写了如下代码：

step2_arr = [
    Text("为了弄出 abc ，我们分别乘c、a、b："),
    MathTex(r"ac = abc + c^2"),
    MathTex(r"ab = abc + a^2"),
    MathTex(r"bc = abc + b^2")
]
step2_group = VGroup(step2_arr).arrange(DOWN, buff=0.3)
self.play(Transform(sum_eq, step2_group))
self.wait(1)

请模仿这种风格进一步修改我下面给出的，我基于你给的代码调整过后的代码，把必要的文字说明和公式放在一个VGroup里展示。
```

## 剪视频

我们参考`media\bili\pku_2021_sf_abc_problem.srt`给每个片段都设置了AI旁白字幕的持续时间，但发现实际的播放时间比旁白播放时间长一些，主要是因为过渡动画也要时间。所以我们还需要剪一下视频。我选用的视频剪辑软件是kdenlive，开源的。

### kdenlive使用心得

1. 字幕可以自定义字体和颜色，所以我换上了站酷快乐体
2. 确定每一段要剪掉的终点：找到过渡动画开始前的最后一帧的大致结束时间。确定起点：找到字幕结束前的最后一帧的大致结束时间。这个似乎不需要特别准确（我还以为那个时间从59到00是突变的，但没想到它其实是`1/60`秒，但这不影响视频的最终效果）。我们可以对最后一段多剪少拉（多退少补）的
3. 记得给BGM设小声点。右键BGM的音频轨道，选择effects，然后默认的音量是0dB，我暂定为`-25dB`
4. 引入动态背景视频：原视频V1轨道，背景视频V2轨道，并在素材的“剪辑属性”栏给背景视频设置Opacity 0.3。视频不太长，复制两份就能填满整个视频。可惜动态背景视频太大了，需要半小时才能导出完毕
5. 为了减少导出时间，我们可以选择拖入jpg，kdenlive会自动把它变成一个5秒的视频。同样在“剪辑属性”手动设置Opacity 0.3，并设置时长和视频一样就行。我的图片是4:3，但视频16:9，这就导致视频有黑边。所以需要设置缩放为1.3333，kdenlive会自动居中对齐
6. 在预览区域右键“导出帧”，就能拿到视频封面
7. 动态背景视频自带音频。但我的项目已经占满2个音轨了，所以我们需要先去“剪辑属性”里把音频干掉，再拖进来
